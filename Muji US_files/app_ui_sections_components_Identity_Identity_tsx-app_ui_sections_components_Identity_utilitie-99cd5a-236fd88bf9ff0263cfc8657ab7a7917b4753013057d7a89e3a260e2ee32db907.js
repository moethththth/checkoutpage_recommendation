"use strict";(self.webpackChunk_SK=self.webpackChunk_SK||[]).push([["app_ui_sections_components_Identity_Identity_tsx-app_ui_sections_components_Identity_utilitie-99cd5a"],{"./app/ui/sections/components/Identity/Identity.tsx":function(e,t,o){o.d(t,{Z:function(){return Mt}});var n=o("../caches/app/node_modules/react/index.js"),a=o("./app/ui/components/Link/Link.tsx"),r=o("./app/ui/components/UserCard/UserCard.tsx"),i=o("./app/ui/components/Section/Section.tsx"),s=o("./app/ui/components/Spacing/Spacing.tsx"),c=o("./app/ui/utilities/context/hooks.ts"),d=o("./app/ui/sections/components/Identity/types/data.ts");const u={sms:d.Ao.SmsVerificationStep,email:d.Ao.EmailVerificationStep,app:d.Ao.AppVerificationStep},l={email:"",phone_number:"",phone_last_digits:"",account_recovery_enabled:!1,enable_email_code_verification:!1,enable_passkey_verification:!1,auth_via_app_detailed_copy:!1,uuid:"",verification_type:"sms",sms_token:"",email_token:"",app_token:"",reCaptchaV2_token:"",reCaptchaV3_token:""},f={email:"",phone:""},b={challenge_displayed:!1,passive_submit:!1,checkbox_ready:!1};function p(e,t){switch(t.type){case d.CV.SetEmail:return{...e,step:d.Ao.EmailStep,user:l,session:{...f,email:t.payload.email},fastLogin:t.payload.fastLogin};case d.CV.SetEmailStep:return{...e,submitState:d.Rb.Ready,step:d.Ao.EmailStep,...t.payload,user:l,session:f,captcha:{...b,checkbox_ready:e.captcha.checkbox_ready}};case d.CV.SetPhoneStep:return{...e,submitState:d.Rb.Ready,...t.payload,session:{...e.session,...t.payload.session},captcha:{...e.captcha,passive_submit:!1,challenge_displayed:!1},step:d.Ao.PhoneStep};case d.CV.SetCaptchaState:return{...e,submitState:d.Rb.Ready,...t.payload,session:{...e.session,...t.payload.session},captcha:{...e.captcha,passive_submit:Boolean(t.payload.captchaAdapter),challenge_displayed:!0,verification_type:t.payload.verificationType}};case d.CV.SetVerificationStep:return{...e,submitState:d.Rb.Ready,...t.payload,user:{...e.user,...t.payload.user},captcha:{...e.captcha,passive_submit:!1,challenge_displayed:!1},step:u[t.payload.user.verification_type]};case d.CV.SetCaptchaReady:return{...e,captcha:{...e.captcha,checkbox_ready:!0}};case d.CV.ResetCaptchaPassiveSubmit:return{...e,captcha:{...e.captcha,passive_submit:!1}};case d.CV.ResetSmsToken:return{...e,user:{...e.user,sms_token:""}};case d.CV.ResetEmailToken:return{...e,user:{...e.user,email_token:""}};case d.CV.ResetAppToken:return{...e,user:{...e.user,app_token:""}};case d.CV.SetWebauthnErrorMessage:case d.CV.SetSubmitState:return{...e,...t.payload};default:return e}}const g=n.createContext(void 0);function h({email:e,source:t,additionalApiPayload:o,experiments:a,onUserCancel:r,onUserFound:i,onUserNotFound:s,onUserSignUp:c,onCaptchaChallenge:u,onCaptchaLoad:h,onLoadExperiments:m,onVerificationSuccess:k,user:y,children:v,tracking:_,layoutStyle:E,texts:S,captchaAdapter:C,signUpEnabled:w=!0,fastLogin:x=!1,submitState:A,step:R,webauthnErrorMessage:P,allowWebauthnAutoPrompt:L,passkeyExpVariant:T}){const[I,O]=(0,n.useReducer)(p,null,(()=>({submitState:A||d.Rb.Ready,webauthnErrorMessage:P||"",step:R||d.Ao.EmailStep,source:t||"login",user:{...l,...y},session:{...f,email:e||""},captcha:{...b,checkbox_ready:"hcaptcha"!==(null==C?void 0:C.config.type)},captchaAdapter:C})));(0,n.useEffect)((()=>{e&&O({type:d.CV.SetEmail,payload:{email:e,fastLogin:x}})}),[e,x,O]),(0,n.useEffect)((()=>{var t;e&&(null===(t=I.captchaAdapter)||void 0===t||t.reset())}),[e,I.captchaAdapter]);const V=(0,n.useCallback)((e=>{k({email:I.user.email,uuid:I.user.uuid,...e})}),[k,I.user.email,I.user.uuid]),N=(0,n.useMemo)((()=>({...I,dispatch:O,tracking:_,additionalApiPayload:o,experiments:a,onUserCancel:r,onUserFound:i,onUserNotFound:s,onUserSignUp:c,onCaptchaChallenge:u,onCaptchaLoad:h,onLoadExperiments:m,onVerificationSuccess:V,layoutStyle:E,texts:S,fastLogin:x,signUpEnabled:w,allowWebauthnAutoPrompt:L,passkeyExpVariant:T})),[o,a,E,r,i,s,c,u,h,m,V,I,_,S,x,w,L,T]);return n.createElement(g.Provider,{value:N},v)}function m(){return(0,c.U)(g,"useIdentityContext","IdentityProvider")}var k=o("./app/ui/utilities/redesign/useRedesign.ts");function y({type:e,children:t}){const{layoutStyle:{sections:o}}=m(),a=(0,k.u)();switch(o[e]){case"none":return n.createElement(n.Fragment,null,t);case"spaced":return a?n.createElement(i.Z,{noMaxWidth:a,border:"none",noTopBorderRadius:!0},n.createElement(s.Z,{all:"unit-5x"},t)):n.createElement(s.Z,{all:"unit-5x"},t);case"spaced-vertical":return n.createElement(s.Z,{vertical:"unit-3x"},t);case"bottom":return n.createElement(i.Z,{border:"bottom",noMaxWidth:a},n.createElement(s.Z,{all:"unit-5x"},t));case"bottom-tight":return n.createElement(i.Z,{border:"bottom",lastChild:!0,noMaxWidth:a},n.createElement(s.Z,{all:"unit-5x"},t));case"top":return n.createElement(i.Z,{border:"top",lastChild:!0,noMaxWidth:a},n.createElement(s.Z,{all:"unit-5x"},t));default:return a?n.createElement(i.Z,{noMaxWidth:a,border:"none"},n.createElement(s.Z,{all:"unit-5x"},t)):n.createElement(i.Z,null,n.createElement(s.Z,{all:"unit-5x"},t))}}let v;!function(e){e.ShopCashBoostsCashBack="shop_cash_boosts_cash_back_experiment"}(v||(v={}));const _={SERVER:"server_error",TIMEOUT:"server_timeout",THROTTLED:"limit_exceeded"};var E=o("./app/ui/types/account.ts"),S=o("./app/ui/utilities/analytics/AnalyticsProvider.tsx"),C=o("./app/ui/utilities/captchaConfig/getCaptchaConfig.ts"),w=o("./app/ui/utilities/url/url.ts"),x=o("./app/ui/api/utilities/ApiFetcher.ts"),A=o("./app/ui/api/utilities/index.ts"),R=o("./app/ui/api/utilities/types.ts");class P extends R.V{constructor(e){super(e,"get experiments"),this.name="GetExperimentsResponseError"}}const L=x.a.default;async function T(e){const t=e?JSON.stringify({experiments:e}):null;try{const e=await L.fetch(w.HQ.experiments(),{method:"POST",headers:A.cV,body:t});if(!e.ok)throw new P(e);return(await e.json()).experiments}catch(o){return async function(e){if(429===e.response.status)throw _.THROTTLED;return async function(e){var t;const{errors:o}=await e.response.json();if(null!==(t=o[0])&&void 0!==t&&t.code)throw o[0].code}(e)}(o)}}class I extends R.V{constructor(e){super(e,"start identity session"),this.name="StartIdentitySessionResponseError"}}class O extends R.V{constructor(e){super(e,"resend app verification"),this.name="ResendAppVerificationResponseError"}}class V extends R.V{constructor(e){super(e,"check webauthn eligibility"),this.name="WebauthnEligibilityResponseError"}}const N=x.a.default;async function D(e){var t;switch(null===(t=e.response)||void 0===t?void 0:t.status){case 429:throw E.fu.THROTTLED;case 404:{const t=await async function(e){let t="";const o=await e.response.text();if(o){var n,a;const e=JSON.parse(o);t=null==e||null===(n=e.errors)||void 0===n||null===(a=n[0])||void 0===a?void 0:a.code}return t}(e);if(t===E.fu.REDIRECT_WITH_EMAIL_ONLY)throw E.fu.REDIRECT_WITH_EMAIL_ONLY;throw E.fu.RECORD_NOT_FOUND}default:return Z(e)}}async function Z(e){if(e.response){var t;const{errors:o}=await e.response.json();if(null!==(t=o[0])&&void 0!==t&&t.code)throw o[0].code}throw e}async function M(e,t="login"){const o=e?JSON.stringify(e):null;try{const e=await N.fetch(function(e){switch(e){case"sign_up":return w.HQ.authenticationSignUp();case"phone":return w.HQ.phoneVerification();default:return w.HQ.authenticationLoginStart()}}(t),{method:"POST",headers:A.cV,body:o});if(!e.ok)throw new I(e);return await e.json()}catch(n){return D(n)}}function F(e,t){return{verification_type:e,..."email"===e&&{email_token:t},..."sms"===e&&{sms_token:t},..."app"===e&&{app_token:t}}}const{locale:U}=window.ShopifyPay.Config;window.hCaptchaScriptAdded=!1,window.hCaptchaLoadedCallbacks=[],window.onHCaptchaLoaded=()=>{for(const e of window.hCaptchaLoadedCallbacks||[])e(window.hcaptcha)};class W extends Error{constructor(){super("A hCaptcha site key is required to load the hCaptcha API"),this.name="HCaptchaSiteKeyMissingError"}}var H;!function(e){e.RateLimited="rate-limited",e.NetworkError="network-error",e.InvalidData="invalid-data",e.ChallengeError="challenge-error",e.ChallengeClosed="challenge-closed",e.ChallengeExpired="challenge-expired",e.MissingCaptcha="missing-captcha",e.InvalidCaptchaId="invalid-captcha-id",e.InternalError="internal-error"}(H||(H={}));class B{constructor(e){this.config=e,this.id="",this.api=null,this.token="",this.renderOptions=null,this.challengeIsShown=!1,this.tokenRequestPromise=null,this.challengeOpenedCallback=null}async getTokenPayload(){return{hcaptcha_token:this.token||await this.getPassiveToken()}}async render(e,t){if(this.shouldRender(t)){var o;const{challengeContainer:n,onChallengeComplete:a,onChallengeShown:r,onCheckboxRendered:i,...s}=t,c=await this.loadApi();this.id&&c.remove(this.id),this.id=c.render(e,{...s,sitekey:this.siteKey,size:"invisible",...n&&{"challenge-container":n},"open-callback":()=>{var e,t,o;null===(e=this.challengeOpenedCallback)||void 0===e||e.call(this),this.challengeIsShown=!0,null===(t=this.renderOptions)||void 0===t||null===(o=t.onChallengeShown)||void 0===o||o.call(t)},callback:e=>{var t,o;this.challengeIsShown&&(null===(t=this.renderOptions)||void 0===t||null===(o=t.onChallengeComplete)||void 0===o||o.call(t,e))}}),null===(o=this.renderOptions)||void 0===o||o.onCheckboxRendered()}}reset(){this.token="",this.challengeOpenedCallback=null,this.challengeIsShown=!1,this.tokenRequestPromise=null}loadApi(){return this.api||(this.api=new Promise((e=>{var t,o;if(window.hcaptcha)return void e(window.hcaptcha);if(window.hCaptchaScriptAdded)return void(null===(o=window.hCaptchaLoadedCallbacks)||void 0===o||o.push((t=>e(t))));const n=document.createElement("script");n.src=`https://js.hcaptcha.com/1/api.js?onload=onHCaptchaLoaded&render=explicit&hl=${U}`,n.async=!0,document.body.appendChild(n),window.hCaptchaScriptAdded=!0,null===(t=window.hCaptchaLoadedCallbacks)||void 0===t||t.push((t=>e(t)))}))),this.api}shouldRender(e){const t=this.renderOptions;if(this.renderOptions=e,!t)return!0;const o=["theme","challengeContainer"];for(const n of o)if(e[n]!==t[n])return!0;return!1}get siteKey(){const e=this.config.hCaptchaSiteKey;if(!e)throw new W;return e}getPassiveToken(){return new Promise(((e,t)=>{this.challengeOpenedCallback=()=>{this.challengeOpenedCallback=null,t(E.fu.CAPTCHA_NEEDED)},this.getTokenPromise().then(e).finally((()=>{this.challengeOpenedCallback=null})).catch(t)}))}async getTokenPromise(){if(!this.tokenRequestPromise){const e=async()=>{const t=await this.loadApi();try{const{response:e}=await t.execute(this.id,{async:!0});return this.token=e,e}catch(o){if([H.ChallengeError,H.ChallengeExpired,H.InternalError,H.ChallengeClosed].includes(o))return e()}return""};this.tokenRequestPromise=e()}return this.tokenRequestPromise}}class j extends Error{constructor(){super("A reCaptcha V3 site key is required to load the reCaptcha API"),this.name="RecaptchaV3SiteKeyMissingError"}}class Q{constructor(e){this.config=e,this.tokenV2="",this.tokenV3="",this.api=null,this.renderOptions=null}async getTokenPayload(){if(this.tokenV2)return{recaptcha_v2_token:this.tokenV2};return{recaptcha_v3_token:this.tokenV3||await this.getPassiveToken()}}async render(e,t){var o;if(this.shouldRender(t)){(await this.loadApi()).render(e,{theme:t.theme,sitekey:this.config.reCaptchaV2SiteKey,callback:e=>{var t,o;this.tokenV2=e,null===(t=this.renderOptions)||void 0===t||null===(o=t.onChallengeComplete)||void 0===o||o.call(t,e)}})}null===(o=this.renderOptions)||void 0===o||o.onCheckboxRendered()}reset(){this.tokenV2="",this.tokenV3=""}get siteKey(){const e=this.config.reCaptchaV3SiteKey;if(!e)throw new j;return e}loadApi(){var e;return this.api||(this.api=(e=this.siteKey,new Promise((t=>{if(window.grecaptcha)return void t(window.grecaptcha);const o=document.createElement("script");o.src=`https://www.google.com/recaptcha/api.js?render=${e}`,o.async=!0,o.addEventListener("load",(()=>{t(window.grecaptcha)})),document.body.appendChild(o)})))),this.api}shouldRender(e){const t=this.renderOptions;if(this.renderOptions=e,!t)return!0;const o=["theme","challengeContainer"];for(const n of o)if(e[n]!==t[n])return!0;return!1}async getPassiveToken(){if(this.tokenV3)return this.tokenV3;const e=await this.loadApi();return new Promise((t=>{try{e.ready((async()=>{const o=await e.execute(this.siteKey,{action:"submit"});this.tokenV3=o,t(o)}))}catch(o){t("")}}))}}function K(e){const t=new{hcaptcha:B,recaptcha:Q}[e.type](e);return"recaptcha"===e.type&&t.loadApi(),t}function Y(){const{trackMonorail:e}=(0,S.Os)(),{goToEmailStep:t,goToPhoneStep:o,goToVerificationStep:a}=function(){const{trackMonorail:e}=(0,S.Os)(),{dispatch:t,tracking:o}=m();return{goToEmailStep:(0,n.useCallback)((n=>{t({type:d.CV.SetEmailStep,payload:{source:n}}),e(o.displayEmailForm)}),[t,e,o.displayEmailForm]),goToPhoneStep:(0,n.useCallback)(((n,a)=>{t({type:d.CV.SetPhoneStep,payload:{session:{email:n},source:a}}),e(o.displayPhoneForm)}),[t,e,o.displayPhoneForm]),goToVerificationStep:(0,n.useCallback)(((e,o)=>{t({type:d.CV.SetVerificationStep,payload:{user:e,source:o}})}),[t])}}(),{dispatch:r,source:i,additionalApiPayload:s,onUserFound:c,onUserNotFound:u,onUserSignUp:l,onCaptchaChallenge:f,onCaptchaLoad:b,onLoadExperiments:p,captchaAdapter:g,tracking:h,captcha:{passive_submit:k},fastLogin:y,signUpEnabled:_}=m(),x=(0,n.useMemo)((()=>"phone"===i?i:"login"),[i]),R=(0,n.useMemo)((()=>"phone"===i?i:"sign_up"),[i]);const P=(0,n.useCallback)((e=>{r({type:d.CV.SetWebauthnErrorMessage,payload:{webauthnErrorMessage:e}})}),[r]);return{identitySessionStart:async function(t,n){const i=n.phone?R:x,m={...s,...n};try{const e=await(null==g?void 0:g.getTokenPayload()),t={...m,...e,fast_login:y},[o,r]=await Promise.allSettled([M(t,i),p?T({[v.ShopCashBoostsCashBack]:n.email}):Promise.reject()]);if("rejected"===o.status)throw o.reason;const s=function(e){const{verification_type:t="sms",token:o="",...n}=e;return{email:n.email||"",uuid:n.uuid||"",phone_number:n.phone_number||"",phone_last_digits:n.phone_last_digits||"",account_recovery_enabled:n.account_recovery_enabled||!1,auth_via_app_detailed_copy:n.auth_via_app_detailed_copy||!1,enable_email_code_verification:n.enable_email_code_verification||!1,enable_passkey_verification:n.enable_passkey_verification||!1,unified_login_original_copy:n.unified_login_original_copy||!1,shop_cash_cashback_enabled:n.shop_cash_cashback_enabled||!1,shop_cash_back_rate:n.shop_cash_back_rate||void 0,...F(t,o)}}(o.value);a(s,i),i===x&&(null==c||c(s)),i===R&&(null==l||l(s)),"fulfilled"===r.status&&(null==p||p(r.value))}catch(S){if(S===E.fu.CAPTCHA_NEEDED)return void function(t,o,n){let a=null;if(!g){const t=(0,C.m)();t?a=K(t):e(h.errorNoCaptchaSetUp)}r({type:d.CV.SetCaptchaState,payload:{session:t,source:o,...a&&{captchaAdapter:a},verificationType:n}}),a?null==b||b():null==f||f();switch(null==g?void 0:g.config.type){case"hcaptcha":e(h.displayHCaptchaForm);break;case"recaptcha":e(h.displayReCaptchaV2Form)}}({email:n.email,...n.phone&&{phone:n.phone}},i,n.verification_type);if(k&&r({type:d.CV.ResetCaptchaPassiveSubmit}),i===x&&S===E.fu.REDIRECT_WITH_EMAIL_ONLY)return void(null==u||u(n.email,S));if(i===x&&(null==u||u(n.email)),S===E.fu.RECORD_NOT_FOUND&&_)return void o(n.email,R);null==g||g.reset(),t(S)}},appVerificationResend:async function(e,t){try{await async function(e){const t=JSON.stringify({token:e});try{const e=await N.fetch(w.HQ.appVerificationResend(),{method:"POST",headers:A.cV,body:t});if(!e.ok)throw new O(e)}catch(o){return D(o)}}(t)}catch(o){e(o)}},setCaptchaReady:function(){r({type:d.CV.SetCaptchaReady})},setSubmitState:(0,n.useCallback)((e=>{r({type:d.CV.SetSubmitState,payload:{submitState:e}})}),[r]),setWebauthnErrorMessage:P,resetUserIdentity:function(){null==g||g.reset(),t(x)},resetSmsToken:function(){r({type:d.CV.ResetSmsToken})},resetEmailToken:function(){r({type:d.CV.ResetEmailToken})},resetAppToken:function(){r({type:d.CV.ResetAppToken})}}}function z({disallowUserChange:e,action:t}){const{user:o,session:i,layoutStyle:{showAvatar:s,showUserPhone:c,smallUserCard:d},onUserCancel:u,texts:{user:l}}=m(),{resetUserIdentity:f}=Y(),b=o.phone_last_digits?l.endingWith(o.phone_last_digits):"",p=(0,n.useMemo)((()=>e?t||null:n.createElement(a.Z,{onClick:function(){null==u||u(),f()}},l.change)),[t,e,l.change,u,f]),g=c&&(o.phone_number||i.phone)||"";return n.createElement(y,{type:"userCard"},n.createElement(r.Z,{email:o.email||i.email,phone:g,phoneAriaLabel:b,action:p,hideAvatar:!s,small:d}))}var q=function(e,t,o,a){const r=(0,n.useRef)(e),i=(0,n.useRef)(a),s=(0,n.useRef)(),c=(0,n.useRef)();return(0,n.useEffect)((()=>{r.current=e,o&&a&&(i.current=a)}),[e,a,o]),(0,n.useEffect)((()=>{if(t)return s.current=setInterval((function(){e&&r.current&&r.current()}),t),()=>{s.current&&clearInterval(s.current)}}),[t,e]),(0,n.useEffect)((()=>{if(o&&s.current)return c.current=setTimeout((()=>{s.current&&clearInterval(s.current),a&&i.current()}),o),()=>{c.current&&clearInterval(c.current)}}),[o,a]),{stopInterval:function(){s.current&&clearInterval(s.current),c.current&&clearInterval(c.current)}}};var $=o("./app/ui/api/account/Account.ts");let J;!function(e){e.Pending="pending",e.Approved="approved",e.Denied="denied",e.Throttled="throttled",e.ResendThrottled="resendThrottled",e.Expired="expired",e.Error="error"}(J||(J={}));const G=500,X=6e5,ee=5e3;class te extends Error{constructor(...e){super(...e),this.name="UseAppVerificationStatusError"}}function oe(e){const{additionalApiPayload:t}=m(),[o,a]=(0,n.useState)(J.Pending),[r,i]=(0,n.useState)(!1),{refreshTimer:s}=function(e,t){const o=(0,n.useRef)(),a=(0,n.useRef)(e);(0,n.useEffect)((()=>{a.current=e}),[e]);const r=(0,n.useCallback)((()=>{var e;null===(e=a.current)||void 0===e||e.call(a)}),[]),i=(0,n.useCallback)((()=>{o.current&&clearTimeout(o.current)}),[]),s=(0,n.useCallback)((()=>{i(),o.current=setTimeout(r,t)}),[t,r,i]);return(0,n.useEffect)((()=>{if(t<=0)throw Error("Delay must be greater than 0");return s(),i}),[t,s,i]),{refreshTimer:s}}((()=>i(!0)),ee);(0,n.useEffect)((()=>{o!==J.Pending?i(!1):s()}),[o,s]),(0,n.useEffect)((()=>{r||s()}),[r,s]);const c=(0,n.useCallback)((async()=>{if(!e.app_token)return;const n={...t,token:`${e.app_token}`,email:e.email};let r;try{switch(await(0,$.Wj)(n)){case"approved":r=J.Approved;break;case"pending":r=J.Pending;break;case"denied":r=J.Denied;break;case"expired":r=J.Expired;break;default:throw new te("Unknown status returned")}}catch{r=J.Error}r!==o&&a(r)}),[e.app_token,e.email,t,o]);const{stopInterval:d}=q(c,G,X,(function(){a(J.Expired)}));return(0,n.useEffect)((()=>{o!==J.Pending&&d()}),[o,d]),{verifiedStatus:o,setVerifiedStatus:a,endPolling:d,showResend:r,setShowResend:i}}var ne=o("../caches/app/node_modules/classnames/index.js"),ae=o.n(ne),re=o("./app/ui/utilities/translation/TranslationProvider.tsx"),ie=o("./app/ui/components/Heading/Heading.tsx");function se({type:e,children:t}){const{layoutStyle:{elements:o,spaces:a}}=m();return o[e]?"none"===a[e]?n.createElement(n.Fragment,null,t):n.createElement(s.Z,{bottom:"unit-6x"},t):null}var ce=o("./app/ui/sections/components/Identity/components/VerificationStep/components/VerificationNotification/VerificationNotification.tsx"),de=o.p+"286daddfdad48ef344fdbd7a781be844b20c6d8d9b6e36364e66f3894097c35f.svg",ue={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",Content:"jRg24",Illustration:"mgVH0",Info:"u1Yeb",Notification:"EniIS",Approved:"KaELT",Error:"un_kn",Denied:"DGQQS",SuccessIcon:"PlW1i",ErrorIcon:"cY5mi",InfoIcon:"ik1QS",medium:"YAOKJ"};function le({verifiedStatus:e,handleNotificationResend:t,switchMethod:o,showDetailedInstructions:r,showResend:i}){const{translate:c}=(0,n.useContext)(re.OB),d=ae()(ue.Info,ue.Pending),u=(0,n.useMemo)((()=>e!==J.Pending&&e!==J.Approved),[e]),{notificationLabel:l,notificationActionLabel:f,notificationActionHandler:b,notificationType:p}=(0,n.useMemo)((()=>{if(!u)return{};switch(e){case J.Throttled:return{notificationLabel:c("settings.login.app_verification.throttled"),notificationType:"error"};case J.ResendThrottled:return{notificationLabel:c("settings.login.error.email_throttled"),notificationType:"error"};case J.Denied:return{notificationLabel:c("settings.login.app_verification.request_denied"),notificationActionLabel:c("settings.login.app_verification.request_try_again"),notificationActionHandler:t,notificationType:"info"};case J.Expired:return{notificationLabel:c("settings.login.app_token_expired.title"),notificationActionLabel:c("settings.login.app_token_expired.action"),notificationActionHandler:t,notificationType:"error"};default:return{notificationLabel:c("settings.recovery.errors.generic"),notificationType:"error"}}}),[u,e,c,t]),g=(0,n.useMemo)((()=>r?"_detailed":""),[r]),h=(0,n.useMemo)((()=>{switch(e){case J.Approved:return n.createElement(s.Z,{bottom:"unit-6x"},n.createElement(ce.Z,{type:"success"},c("settings.login.app_verification.approved")));case J.Pending:return i?n.createElement(s.Z,{bottom:"unit-6x"},n.createElement(ce.Z,{type:"info"},c("settings.login.app_verification.request_not_received")," ",n.createElement(a.Z,{onClick:t},c("settings.login.app_verification.request_resend")))):null;default:return n.createElement(s.Z,{bottom:"unit-6x"},n.createElement(ce.Z,{type:p},l,b&&f&&n.createElement(a.Z,{onClick:b},f)))}}),[e,c,i,t,l,b,f,p]),m=n.createElement(se,{type:"formTitle"},n.createElement(s.Z,{bottom:"unit-2x"},n.createElement(ie.Z,null,c("settings.login.app_verification.title"))));return n.createElement("div",{className:ue.Content},m,n.createElement("div",{className:d},n.createElement("div",{"aria-live":"assertive",role:"alert"},c(`settings.login.app_verification.instructions${g}`,{shopApp:n.createElement("span",{className:ue.medium,key:"Shop"},"Shop"),affirmative:n.createElement("span",{className:ue.medium,key:"Affirmative"},c(`settings.login.app_verification.affirmative${g}`))}))),n.createElement(s.Z,{vertical:"unit-6x"},n.createElement("img",{src:de,alt:c("settings.login.app_verification.illustration_alt"),className:ue.Illustration})),h,n.createElement("div",{className:ue.Footer},e!==J.Approved&&n.createElement("div",{className:ue.SMSLink},n.createElement(a.Z,{onClick:o},c("settings.login.app_verification.alternative")))))}function fe({switchMethod:e}){const{trackMonorail:t}=(0,S.Os)(),{user:o,tracking:a,additionalApiPayload:r,source:i,onVerificationSuccess:s}=m(),{verifiedStatus:c,setVerifiedStatus:d,endPolling:u,showResend:l,setShowResend:f}=oe(o),{identitySessionStart:b,resetAppToken:p,appVerificationResend:g}=Y();return(0,n.useEffect)((()=>{c===J.Approved&&async function(){try{const e=await(0,$.W3)({...r,verification_token:o.app_token||"",verification_type:"app"},i);s({...e})}catch{d(J.Error)}}()}),[r,o,c,d,i,s]),(0,n.useEffect)((()=>{t(a.displayAppVerificationForm(o.uuid||""))}),[t,a,o.uuid]),(0,n.useEffect)((()=>{o.app_token||async function(){const e={email:o.email,verification_type:"app"};try{await b((()=>{d(J.Throttled),u()}),e)}catch{d(J.Error)}}()}),[b,o.email,o.app_token,d,u]),n.createElement(le,{verifiedStatus:c,handleNotificationResend:async function(){if(l){f(!1);const e=o.app_token;if(!e)return;await g((()=>{d(J.ResendThrottled)}),e)}else p(),d(J.Pending)},switchMethod:e,showDetailedInstructions:o.auth_via_app_detailed_copy,showResend:l})}var be=o("./app/ui/utilities/analytics/sectionEvents/loginEvents.ts"),pe=o("./app/ui/utilities/errors/Errors.ts"),ge={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",FormDescription:"koxGj"};function he({children:e}){return e?n.createElement("div",{className:ge.FormDescription},e):null}var me={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",FormTitle:"r6uw3"};function ke({children:e}){return e?n.createElement(s.Z,{bottom:"unit-2x"},n.createElement(ie.Z,null,n.createElement("div",{className:me.FormTitle},e))):null}var ye=o("./app/ui/components/CodeInput/CodeInput.tsx"),ve=o("./app/ui/components/AnimatedShopLogo/AnimatedShopLogo.tsx"),_e=o("./app/ui/components/DoubleSpinnerIcon/DoubleSpinnerIcon.tsx"),Ee=o("./app/ui/components/Notification/Notification.tsx"),Se=o("./app/ui/components/Icon/Icon.tsx");function Ce(){return Ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},Ce.apply(this,arguments)}var we=e=>n.createElement("svg",Ce({viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},e),n.createElement("path",{fillRule:"evenodd",d:"M16.695 12.133c-.298.213-.392.659-.133.918a.776.776 0 0 1 0 1.098l-.118.117a.943.943 0 0 0 0 1.334.943.943 0 0 1 0 1.333l-.757.758a.5.5 0 0 1-.707 0l-1.132-1.132a1 1 0 0 1-.292-.707v-3.44a3.111 3.111 0 1 1 3.139-.279Zm-1.806-3.867a.889.889 0 1 1 0 1.778.889.889 0 0 1 0-1.778Z",fill:void 0}),n.createElement("path",{d:"M10.702 11.093c-.699-.163-1.52-.259-2.48-.259-5.055 0-6.222 2.642-6.222 3.95 0 1.31 1.045 2.371 2.333 2.371h7.778c.037 0 .074 0 .111-.003v-3.997a4.456 4.456 0 0 1-1.52-2.062ZM8 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z",fill:void 0})),xe=o("../caches/app/node_modules/@bugsnag/js/browser/notifier.js"),Ae=o.n(xe),Re=o("../caches/app/node_modules/@github/webauthn-json/dist/esm/webauthn-json.browser-ponyfill.js"),Pe=o("./app/ui/utilities/passkey/isPasskeysLoginSupported.ts"),Le=o("./app/ui/types/webauthn_credential.ts"),Te=o("./app/ui/utilities/passkey/api.ts");class Ie extends Error{constructor(){super("No public key credential request options returned from challenge request"),this.name="PasskeysNoPublicKeyOptionsError"}}class Oe extends Error{constructor(){super("Passkey login is not enabled"),this.name="PasskeyLoginNotEnabledError"}}var Ve=o("./app/ui/utilities/passkey/useAbortController.ts");const Ne="Cancel passkey autofill";const De=/^[^\s@[\]{}]+@[^\s@[\]{}]+\.[^\s@[\]{}]+$/;function Ze(e){return RegExp(De).test(e)}const Me=e=>{const[t,o]=(0,n.useState)(0===e.length),[a,r]=(0,n.useState)(!1),i=(e=>{const t=(0,n.useRef)(),[o,a]=(0,n.useState)(e);return(0,n.useEffect)((()=>(t.current=window.setTimeout((()=>{a(e)}),300),()=>{window.clearTimeout(t.current)})),[e]),o})(e),s=(0,n.useMemo)((()=>Ze(i)&&window.AbortController?new window.AbortController:void 0),[i]),c=(0,n.useCallback)((async()=>{try{const{success:e,auto:t}=await async function(e,t){try{const o=await N.fetch(w.HQ.webauthnEligibility(e),{method:"GET",headers:A.cV,signal:t});if(!o.ok)throw new V(o);return o.json()}catch(o){return Z(o)}}(i,null==s?void 0:s.signal);o(Boolean(e)),r(Boolean(t))}catch(e){"AbortError"!==e.name&&Ae().notify(e)}}),[i,s]);return(0,n.useEffect)((()=>{o(0===e.length),r(!1)}),[e]),(0,n.useEffect)((()=>{o(0===i.length),r(!1),Ze(i)&&c()}),[i,c]),(0,n.useEffect)((()=>()=>{null==s||s.abort()}),[s,i]),{eligible:t,autoPrompt:a&&t}};var Fe={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",PasskeysAuth:"QBrNx",PasskeyButton:"IphnM"};function Ue({email:e,layout:t,labelText:o}){const{trackMonorail:r}=(0,S.Os)(),{additionalApiPayload:i,tracking:s,submitState:c,step:u,onVerificationSuccess:l,allowWebauthnAutoPrompt:f,passkeyExpVariant:b}=m(),{setSubmitState:p,setWebauthnErrorMessage:g}=Y(),h=(0,n.useCallback)((()=>{p(d.Rb.Loading)}),[p]),k=(0,n.useCallback)((()=>{p(d.Rb.Ready)}),[p]),{isPasskeySupported:y,startWebauthnLogin:v}=function({additionalApiPayload:e,onError:t,onLoading:o,onReady:a,onSuccess:r}){const{translate:i}=(0,n.useContext)(re.OB),{getSignal:s}=(0,Ve.Z)(Ne),c=(0,n.useMemo)(Pe.Z,[]),d=(0,n.useCallback)((e=>{switch(e){case Le.b.CREDENTIALS_NOT_FOUND:return i("settings.login.email_form.passkeys.errors.invalid");case E.fu.THROTTLED:return i("settings.login.error.email_throttled");default:return i("settings.login.email_form.passkeys.errors.generic")}}),[i]),u=(0,n.useCallback)((async o=>{try{const t=await(0,$.W3)({...e,verification_token:JSON.stringify(o),verification_type:"webauthn"});null==r||r(t)}catch(n){Ae().notify(n),null==a||a(),null==t||t(d(n))}}),[t,a,r,e,d]),l=(0,n.useCallback)((async e=>{try{const t=await(0,Re.U2)((0,Re.wz)({publicKey:e,signal:s()}));await u(t)}catch(n){var o;if(null!==(o=s())&&void 0!==o&&o.aborted||"NotAllowedError"===n.name)return void(null==a||a());Ae().notify(n),null==a||a(),null==t||t(d(n))}}),[a,s,u,t,d]),f=(0,n.useCallback)((async n=>{try{if(null==o||o(),!c)throw new Oe;const t=await(0,Te.h)({...e,email:n});if(null==t||!t.public_key_credential_request_options)throw new Ie;l(t.public_key_credential_request_options)}catch(r){Ae().notify(r),null==a||a(),null==t||t(d(r))}}),[t,o,a,c,e,l,d]);return{isPasskeySupported:c,startWebauthnLogin:f}}({additionalApiPayload:i,onError:g,onLoading:h,onReady:k,onSuccess:l});(0,n.useEffect)((()=>{y&&r(s.displayPasskeyLoginButton(u))}),[]);const _=(0,n.useCallback)((t=>{t.stopPropagation();t.target.focus(),r(s.clickPasskeyLoginButton(u)),v(e),g("")}),[r,s,u,v,e,g]),{eligible:C,autoPrompt:w}=Me(e??""),x=(0,n.useRef)();if((0,n.useEffect)((()=>{f&&t===d.Qi.Button&&x.current!==e&&w&&"no-button"!==b&&(x.current=e,r(s.autoPromptPasskeyLogin(u)),v(e))}),[w]),!y)return null;const A=c===d.Rb.Loading,R=A||!C;switch(t){case d.Qi.Link:return n.createElement(a.Z,{onClick:_,disabled:A},n.createElement("div",{className:Fe.PasskeysAuth},n.createElement(Se.Z,{svg:we,size:20}),o));case d.Qi.Button:return"no-button"===b?null:n.createElement("button",{type:"button","aria-label":o,disabled:R,onClick:_,className:Fe.PasskeyButton},n.createElement(Se.Z,{svg:we,size:24}));default:return null}}var We={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",VerificationFooter:"wRbu8",VerificationFooterWithSeparator:"vTRtf",VerificationFooterWithError:"APQGC"};function He({customAction:e}){const{source:t,texts:{passkeysLabel:o},layoutStyle:{verificationFooter:a},submitState:r,user:{enable_passkey_verification:i,email:c},webauthnErrorMessage:u}=m(),l=(0,n.useMemo)((()=>i&&"login"===t?n.createElement(Ue,{labelText:o,layout:d.Qi.Link,email:c}):null),[i,o,t,c]),f=(0,n.useMemo)((()=>r===d.Rb.Loading?n.createElement(_e.Z,null):e),[e,r]);if(!l&&!f)return null;const b=Boolean(l&&e),p=ae()(We.VerificationFooter,b&&We.VerificationFooterWithSeparator,u&&We.VerificationFooterWithError),g={...a.marginTop&&{top:a.marginTop},...a.marginBottom&&{bottom:a.marginBottom}};return n.createElement(s.Z,g,n.createElement("div",{className:p},u&&n.createElement(s.Z,{top:"unit-3x",bottom:"unit-3x"},n.createElement(Ee.Z,{label:u,type:"error"})),l,f))}var Be={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",CustomMessage:"dHdRG",AnimatedShopLogo:"WJJ2D"};function je({title:e,inputLabel:t,inputDescribedBy:o,description:a,notification:r,customFormMessage:i,customAction:c,onCodeComplete:u,pending:l}){const[f,b]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),{submitState:h}=m(),{setSubmitState:k}=Y();const y=(0,n.useMemo)((()=>Boolean(i)&&!r?n.createElement("div",{className:Be.CustomMessage},i):void 0),[r,i]);return n.createElement(n.Fragment,null,e,a,!l&&n.createElement(ye.Z,{ariaLabel:t,describedBy:o,loading:h===d.Rb.Loading,error:p||Boolean(f),onChange:async function(e,t){if(!t)return k(d.Rb.Ready),b(""),void g("");try{k(d.Rb.Loading),b(""),g(""),await u(e)}catch(o){k(d.Rb.Ready),o instanceof pe.S6&&b(o.message),o instanceof pe.cp&&g(o.message)}},message:y,id:"identity-verification-code"}),l&&n.createElement(n.Fragment,null,n.createElement("div",{className:Be.AnimatedShopLogo},n.createElement(ve.Z,{color:"brand"})),y&&n.createElement(s.Z,{top:"unit-2x"},y)),r,f&&n.createElement(s.Z,{top:"unit-6x"},n.createElement(ce.Z,{type:"error"},f)),n.createElement(He,{customAction:c}))}class Qe extends Error{constructor(...e){super(...e),this.name="EmailVerificationTokenError"}}class Ke extends Error{constructor(...e){super(...e),this.name="EmailVerificationCodeCompleteError"}}function Ye({onOptOut:e}){const t=(0,n.useRef)(!1),[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),{checkoutVersion:u,trackStatsD:l,trackMonorail:f}=(0,S.Os)(),b=(0,n.useMemo)(Pe.Z,[]),{additionalApiPayload:p,source:g,texts:{verificationStep:{customMessage:h,email:k,title:y}},tracking:v,user:_,onVerificationSuccess:C}=m(),{identitySessionStart:w,resetEmailToken:x}=Y();(0,n.useEffect)((()=>{f(v.displayEmailVerificationForm(_.uuid||""))}),[f,v,_.uuid]);const A=(0,n.useCallback)((e=>e===E.fu.THROTTLED?(r(!0),""):k.errors.generic),[r,k.errors.generic]);(0,n.useEffect)((()=>(t.current=!0,_.email_token||c||o||async function(){const e={email:_.email,..."sign_up"===g&&{phone:_.phone_number},verification_type:"email"};d(!0);try{await w((e=>{throw new pe.S6(A(e))}),e)}catch(o){}finally{t.current&&d(!1)}}(),()=>{t.current=!1})),[g,A,w,_.email,_.email_token,_.phone_number,c,o]);const R=(0,n.useRef)(Date.now());const P=(0,n.useCallback)((async()=>{s(!1),await x()}),[x,s]),L=(0,n.useMemo)((()=>i?n.createElement(ce.Z,{type:"info"},n.createElement(n.Fragment,null,k.expired.title," ",n.createElement(a.Z,{onClick:P},k.expired.action))):o?n.createElement(ce.Z,{type:"error"},n.createElement(n.Fragment,null,k.throttled.description," ",k.throttled.title)):void 0),[i,k,o,P]),T=n.createElement(se,{type:"formTitle"},n.createElement(ke,null,y||k.title)),I=k.description?n.createElement(se,{type:"formDescription"},n.createElement(he,null,k.description(_.email))):null,O=e?n.createElement(a.Z,{onClick:e},k.optOut):null;return n.createElement(je,{title:T,description:I,inputLabel:k.label,inputDescribedBy:"modal-content",customAction:O,customFormMessage:h,onCodeComplete:async function(e){try{const t=Date.now();await l.histogram(be.$,t-R.current,{checkout_version:u});const o=await(0,$.W3)({...p,verification_token:_.email_token||"",verification_type:"email",code:e,passkeys_supported:b.toString()},g);C({...o})}catch(t){if(t===E.fu.INVALID_TOKEN||t===E.fu.EXPIRED_TOKEN)throw s(!0),new Qe(t);if(t===E.fu.INVALID_CODE)throw new pe.cp(k.errors.notValid);const e=A(t);if(e)throw new pe.S6(e);throw new Ke}},notification:L,pending:c})}class ze extends Error{constructor(...e){super(...e),this.name="SmsVerificationTokenError"}}class qe extends Error{constructor(...e){super(...e),this.name="SmsVerificationCodeCompleteError"}}function $e({onOptOut:e,fallbackOptOut:t}){const[o,r]=(0,n.useState)(!1),[i,s]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),{checkoutVersion:u,trackStatsD:l,trackMonorail:f}=(0,S.Os)(),b=(0,n.useMemo)(Pe.Z,[]),{additionalApiPayload:p,source:g,texts:{verificationStep:{customMessage:h,sms:k,title:y}},tracking:v,user:_,onVerificationSuccess:C}=m(),{identitySessionStart:w}=Y();(0,n.useEffect)((()=>{f(v.displaySmsVerificationForm(_.uuid||""))}),[f,v,_.uuid]);const x=(0,n.useRef)(Date.now());const A=(0,n.useCallback)((async()=>{d(!0),s(!1),await w((()=>{r(!0)}),{email:_.email,..."sign_up"===g&&{phone:_.phone_number},verification_type:"sms"}),d(!1)}),[w,_.email,_.phone_number,g]);(0,n.useEffect)((()=>{_.sms_token||c||A()}),[A,_.sms_token,c]);const R=(0,n.useMemo)((()=>i?n.createElement(ce.Z,{type:"info"},n.createElement(n.Fragment,null,k.expired.title," ",n.createElement(a.Z,{onClick:A},k.expired.action))):o?n.createElement(ce.Z,{type:"error"},n.createElement(n.Fragment,null,k.throttled.description," ",k.throttled.title)):void 0),[i,k,A,o]),P=n.createElement(se,{type:"formTitle"},n.createElement(ke,null,y||k.title)),L=k.description?n.createElement(se,{type:"formDescription"},n.createElement(he,null,k.description,n.createElement("span",{"aria-live":"polite",className:"visuallyHidden",id:"modal-content"},k.endingWith(_.phone_last_digits.split("").join("-"))))):null,T=e&&k.optOut?n.createElement(a.Z,{onClick:e},k.optOut):t||null;return n.createElement(je,{title:P,description:L,inputLabel:k.label,inputDescribedBy:"modal-content",customAction:T,customFormMessage:h,onCodeComplete:async function(e){try{const t=Date.now();await l.histogram(be.$,t-x.current,{checkout_version:u});const o=await(0,$.W3)({...p,verification_token:_.sms_token||"",verification_type:"sms",code:e,passkeys_supported:b.toString()},g);C({...o})}catch(t){if(t===E.fu.INVALID_TOKEN)throw s(!0),new ze(t);if(t===E.fu.INVALID_CODE)throw new pe.cp(k.errors.notValid);const e=function(e){return e===E.fu.THROTTLED?(r(!0),""):k.errors.generic}(t);if(e)throw new pe.S6(e);throw new qe(t)}},notification:R,pending:c})}function Je({fallbackSmsOptOut:e}){const{tracking:t,user:o}=m(),[a,r]=(0,n.useState)(o.verification_type),{trackMonorail:i}=(0,S.Os)();function s(e){i(t.switchVerificationType(o.uuid||"")),r(e)}function c(){a===d.R4.SmsVerification?s(d.R4.EmailVerification):s(d.R4.SmsVerification)}const u=()=>s(d.R4.SmsVerification),l=o.account_recovery_enabled&&o.enable_email_code_verification?c:void 0;return n.createElement(y,{type:"verification"},function(){switch(a){case d.R4.AppVerification:return n.createElement(fe,{switchMethod:u});case d.R4.EmailVerification:return n.createElement(Ye,{onOptOut:c});case d.R4.SmsVerification:default:return n.createElement($e,{onOptOut:l,fallbackOptOut:e})}}())}var Ge=o("./app/ui/utilities/retail/usePointOfSale.ts"),Xe=o("./app/ui/components/Input/Input.tsx"),et=o("./app/ui/components/FlagInput/FlagInput.tsx"),tt=o("./app/ui/components/Button/Button.tsx"),ot=o("./app/ui/utilities/phone_number_formatter/usePhoneNumberLib.ts"),nt=o("./app/ui/utilities/phone_number_formatter/formatter.ts"),at=o("./app/ui/utilities/CountriesProvider/CountriesProvider.tsx"),rt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",LegalCopy:"hOY9c"};function it(){const{translate:e}=(0,n.useContext)(re.OB);return n.createElement(s.Z,{top:"unit-3x"},n.createElement("p",{className:rt.LegalCopy,"data-testid":"privacy-policy"},e("settings.login.legal_html",{terms_of_service:n.createElement(a.Z,{external:!0,key:"url-tos",href:window.ShopifyPay.Config.termsOfServicePath},e("general.terms_of_service_inline")),privacy_policy:n.createElement(a.Z,{external:!0,key:"url-pp",href:window.ShopifyPay.Config.privacyPolicyPath},e("general.privacy_policy"))})))}var st,ct,dt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",Form:"NFkFj",Link:"L9CAe",InputWrapper:"xVH8a"};const{geolocation:{country_code:ut="US"}}=(null===(st=window)||void 0===st||null===(ct=st.ShopifyPay)||void 0===ct?void 0:ct.Config)||{},lt=/^\+?[0-9().\s-]+$/;function ft({title:e,description:t,placeholder:o,buttonContent:a,showLegalCopy:r,onSubmit:i}){const c=(0,n.useContext)(at.KJ),[u,l]=(0,n.useState)(ut),[f,b]=(0,n.useState)(""),[p,g]=(0,n.useState)(""),[h,k]=(0,n.useState)(0),[y,v]=(0,n.useState)(""),_=(0,n.useRef)(null),E=(0,ot.X)(),{texts:{phoneStep:S},layoutStyle:{mobileOptimizedInputs:C},submitState:w}=m(),{setSubmitState:x}=Y();return(0,n.useEffect)((()=>{if(!c)return;const{phone_number_prefix:e=""}=c[u]||{};g(e),f||k(e.length)}),[c,u,f]),(0,n.useEffect)((()=>{var e;null===(e=_.current)||void 0===e||e.setSelectionRange(h,h)}),[h,f]),n.createElement("form",{className:dt.Form,onSubmit:async function(e){var t;if(e.preventDefault(),t=f,RegExp(lt).test(t)&&f.trim()!==p)try{x(d.Rb.Loading),await i(f)}catch(o){o instanceof pe.W2&&(v(o.message),x(d.Rb.Ready))}else v(S.errors.notValid)},noValidate:!0},e,n.createElement("span",{id:"phone-number-form-description"},t),n.createElement(s.Z,{vertical:"unit-3x"},n.createElement("div",{className:dt.InputWrapper},n.createElement(Xe.Z,{autoComplete:"tel",ref:_,focus:!0,describedBy:"phone-number-form-description",id:"phone-number",label:o,required:!0,type:"tel",value:f||p,onChange:function(e){if(e){var t;const o=(null===(t=_.current)||void 0===t?void 0:t.selectionStart)??e.length,n=(0,nt.WU)(e,E,u),a=(0,nt.vl)(n,u,E);a&&l(a),n&&(b(n),k((0,nt.Z8)(o,e,n)))}else b(p),k(p.length+1);v("")},mobileOptimized:C}),c&&u&&n.createElement(et.Z,{countries:c,geolocatedCountryCode:u,phoneNumber:f||p,onChange:function(e,t){const o=(0,nt.I$)(f,(0,nt.pQ)(e,E),(0,nt.pQ)(t,E)),n=(0,nt.WU)(o,E,u);l(t),b(n)},phoneLib:E}))),y&&n.createElement(s.Z,{bottom:"unit-3x"},n.createElement(Ee.Z,{type:"error",label:y})),n.createElement(tt.Z,{primary:!0,disabled:"loading"===w,loading:"loading"===w},a),r&&n.createElement(it,null))}function bt({showLegalCopy:e}){const{identitySessionStart:t}=Y(),{session:o,texts:{phoneStep:a}}=m(),r=(0,Ge.g)(),i=(0,n.useCallback)((e=>{switch(e){case E.fu.THROTTLED:return a.errors.throttled;case E.fu.INVALID_PHONE:case E.fu.BLOCKED_PHONE:return a.errors.notValid;case E.fu.PHONE_LIMIT_REACHED:return a.errors.tooMany;default:return a.errors.generic}}),[a]);const s=r?a.posTitle:a.title,c=n.createElement(se,{type:"formTitle"},n.createElement(ke,null,s)),d=n.createElement(se,{type:"formDescription"},n.createElement(he,null,a.description));return n.createElement(y,{type:"phone"},n.createElement(ft,{title:c,description:d,placeholder:a.placeholder,buttonContent:a.buttonContent,showLegalCopy:e&&!r,onSubmit:async function(e){o&&await t((e=>{throw new pe.W2(i(e))}),{email:o.email,phone:e})}}))}var pt=o("./app/ui/utilities/UIContextProvider/UIContextProvider.tsx"),gt=o("./app/ui/utilities/browser/cookies.ts");const ht=()=>({conditionalUIEnabled:"true"===(0,gt.e)("enable_conditional_ui_chrome")});var mt=o("./app/ui/sections/components/ShopAuthInputField/ShopAuthInputField.tsx"),kt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",InputRow:"QygAu"};const yt=/^[^@]+@[^@]+\.[^@]+$/;function vt({title:e,description:t,placeholder:o,buttonContent:a,initialEmail:r="",onSubmit:i,errorMessage:c=""}){const{additionalApiPayload:u,texts:{emailStep:l},layoutStyle:{mobileOptimizedInputs:f},submitState:b,onVerificationSuccess:p,webauthnErrorMessage:g}=m(),{isShopServer:h}=(0,pt.MS)(),[k,y]=(0,n.useState)(r),[v,_]=(0,n.useState)(c),{setSubmitState:E,setWebauthnErrorMessage:S}=Y(),C=(0,n.useRef)(null);(0,n.useEffect)((()=>{c&&_(c)}),[c]);const w=(0,n.useCallback)((()=>{var e,t;null===(e=C.current)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e)}),[]),x=(0,n.useCallback)((e=>{"Enter"===e.key&&w()}),[w]),A=(0,n.useCallback)((e=>{y(e.trim()),_(""),S("")}),[S]),R=(0,n.useCallback)((async e=>{if(e.preventDefault(),function(e){return RegExp(yt).test(e)}(k))try{E(d.Rb.Loading),await i(k)}catch(t){t instanceof pe.Ot&&(_(t.message),E(d.Rb.Ready))}else _(l.errors.notValid)}),[k,l.errors.notValid,i,E]),{conditionalUIEnabled:P}=ht(),L=(0,n.useCallback)((()=>{var e,t;E(d.Rb.Loading),null===(e=C.current)||void 0===e||null===(t=e.blur)||void 0===t||t.call(e)}),[E]),T=(0,n.useCallback)((()=>{E(d.Rb.Ready)}),[E]),I=(0,n.useCallback)((e=>{_(e)}),[]);return n.createElement("form",{onSubmit:R,noValidate:!0},e,t&&n.createElement("span",{id:"email-form-description"},t),n.createElement(s.Z,{vertical:"unit-3x"},n.createElement("div",{className:kt.InputRow,onClick:w,onKeyUp:x},P?n.createElement(mt.Z,{id:"IdentityEmailForm-input",describedBy:"email-form-description",inputRef:C,mobileOptimized:f,placeholder:o,value:k,onChange:A,additionalAuthPayload:u,onAuthSuccess:p,onAuthError:I,onAuthLoading:L,onAuthReady:T,noBorder:!0}):n.createElement(n.Fragment,null,n.createElement(Xe.Z,{describedBy:"email-form-description",id:"IdentityEmailForm-input",ref:C,label:o,required:!0,value:k,autoComplete:"email",type:"email",onChange:A,mobileOptimized:f,noBorder:!0}),n.createElement(Ue,{email:k,labelText:l.passkeyLabel,layout:d.Qi.Button})))),(v||g)&&n.createElement(s.Z,{bottom:"unit-3x"},n.createElement(Ee.Z,{label:v||g,type:"error"})),n.createElement(tt.Z,{primary:!0,disabled:b===d.Rb.Loading,loading:b===d.Rb.Loading,rounded:h},a))}var _t={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",Loader:"WM_si"};function Et(){const{translate:e}=(0,n.useContext)(re.OB),[t,o]=(0,n.useState)(!1),{isShopServer:a}=(0,n.useContext)(pt.QE),{identitySessionStart:r,resetUserIdentity:i}=Y(),{session:c,texts:{emailStep:d},captcha:{checkbox_ready:u}}=m(),[l,f]=(0,n.useState)(""),[b,p]=(0,n.useState)(""),[g,h]=(0,n.useState)(""),k=(0,Ge.g)(),v=(0,n.useCallback)((e=>{switch(e){case E.fu.THROTTLED:return o(!0),d.errors.throttled;case E.fu.INVALID_EMAIL:return d.errors.notValid;default:return d.errors.generic}}),[d.errors.generic,d.errors.notValid,d.errors.throttled]),_=(0,n.useCallback)((async e=>{p(e),await r((e=>{if(!a||e!==E.fu.RECORD_NOT_FOUND){if(h(v(e)),!c.email)throw new pe.Ot(v(e));i()}}),{email:e})}),[c.email,v,r,i,a]);if((0,n.useEffect)((()=>{p(""),f("")}),[null==c?void 0:c.email]),(0,n.useEffect)((()=>{!c.email||b||t||(l&&u?_(l):f(c.email))}),[l,_,c.email,b,t,u]),c.email)return n.createElement(se,{type:"loader"},n.createElement(s.Z,{bottom:"unit-4x"},n.createElement("div",{className:_t.Loader},n.createElement(ve.Z,{color:"brand",ariaLabel:e("general.loading")}))));const S=k?d.posTitle:d.title,C=n.createElement(se,{type:"formTitle"},n.createElement(ke,null,S)),w=k?d.posDescription:d.description,x=n.createElement(se,{type:"formDescription"},n.createElement(he,null,w));return n.createElement(y,{type:"email"},n.createElement(vt,{title:C,description:x,placeholder:d.placeholder,buttonContent:d.buttonContent,onSubmit:_,errorMessage:g,initialEmail:l}))}var St={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",IdentityTitle:"s9b8k"};function Ct(){const{step:e,texts:t}=m(),o=(0,n.useMemo)((()=>{switch(e){case d.Ao.EmailStep:return t.emailStep.title||"";case d.Ao.PhoneStep:return t.phoneStep.title||"";case d.Ao.SmsVerificationStep:return t.verificationStep.title||t.verificationStep.sms.title||"";case d.Ao.EmailVerificationStep:return t.verificationStep.title||t.verificationStep.email.title||"";case d.Ao.AppVerificationStep:return t.verificationStep.title||t.verificationStep.app.title||"";default:return e}}),[e,t.emailStep.title,t.phoneStep.title,t.verificationStep.title,t.verificationStep.sms.title,t.verificationStep.email.title,t.verificationStep.app.title]);return n.createElement("div",{className:St.IdentityTitle},n.createElement(s.Z,{bottom:"unit-6x"},n.createElement(ie.Z,null,o)))}var wt=o("./app/ui/utilities/ThemeProvider/ThemeProvider.tsx"),xt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",ReCaptchaV2Wrapper:"ONnHb",ChallengeContainer:"dfzOD"};function At({onChallengeComplete:e,onChallengeShown:t,onCheckboxRendered:o}){const{setCaptchaReady:a}=Y(),{captchaAdapter:r,captcha:{checkbox_ready:i}}=m(),s=(0,n.useRef)(null),c=(0,n.useContext)(wt.G),[d,u]=(0,n.useState)(null),l=(0,n.useMemo)((()=>{const e=document.createElement("div");return e.classList.add(xt.ChallengeContainer),e}),[]),f=(0,n.useCallback)((()=>{null==o||o(),i||a()}),[i,o,a]);(0,n.useEffect)((()=>{d&&d.appendChild(l)}),[l,d]),(0,n.useEffect)((()=>{s.current&&(null==r||r.render(s.current,{theme:c?"dark":"light",onChallengeComplete:e,onCheckboxRendered:f,onChallengeShown:t,challengeContainer:l}))}),[l,r,c,e,f,t]);const b=ae()({[xt.ReCaptchaV2Wrapper]:"recaptcha"===(null==r?void 0:r.config.type)});return n.createElement(n.Fragment,null,n.createElement("div",{ref:s,className:b}),"hcaptcha"===(null==r?void 0:r.config.type)&&n.createElement("div",{ref:u}))}function Rt(){const[e,t]=(0,n.useState)(""),{identitySessionStart:o}=Y(),{session:a,texts:{emailStep:r}}=m(),i=(0,n.useCallback)((async()=>{await o((()=>{t(r.errors.generic)}),a)}),[r.errors.generic,o,a]);return n.createElement(y,{type:"captcha"},e&&n.createElement(s.Z,{bottom:"unit-3x"},n.createElement(Ee.Z,{label:e,type:"error"})),n.createElement(s.Z,{vertical:"unit-3x"},n.createElement(At,{onChallengeComplete:i})))}var Pt,Lt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",Hidden:"SVbtb",CaptchaHeading:"uEe7q",LoaderContainer:"Xg1Pv"};function Tt(){const[e,t]=(0,n.useState)(Pt.Loading),{session:o,texts:{emailStep:a,captcha:{title:r}},captcha:{passive_submit:i,challenge_displayed:c,verification_type:d},layoutStyle:u}=m(),{identitySessionStart:l}=Y(),[f,b]=(0,n.useState)(""),p=(0,n.useCallback)((async()=>{let e="";t(Pt.Submitting),await l((()=>{e=a.errors.generic}),{...o,verification_type:d}),t((e=>e===Pt.ChallengeShown?Pt.ChallengeShown:Pt.Ready)),b(e)}),[a.errors.generic,l,o,d]),g=(0,n.useCallback)((()=>{t(Pt.ChallengeShown)}),[]),h=(0,n.useCallback)((()=>{t(Pt.Ready)}),[]);(0,n.useEffect)((()=>{e===Pt.Ready&&i&&p()}),[p,i,e]),(0,n.useEffect)((()=>{c&&b("")}),[c]);const k=ae()({[Lt.Hidden]:!c||c&&[Pt.Loading,Pt.Ready].includes(e)&&!f,[Lt.CaptchaContainer]:!0}),v=ae()(e!==Pt.ChallengeShown&&Lt.Hidden),_=ae()(!(u.showCaptchaHeader&&e===Pt.ChallengeShown)&&Lt.Hidden,Lt.CaptchaHeading);return n.createElement("div",{className:k},n.createElement(y,{type:"captcha"},n.createElement("div",{className:_},n.createElement(s.Z,{top:"unit-5x",horizontal:"unit-5x",bottom:"unit-3x"},n.createElement(ie.Z,null,r))),f&&n.createElement(s.Z,{vertical:"unit-3x",horizontal:"unit-4x"},n.createElement(Ee.Z,{label:f,type:"error"})),n.createElement("div",{className:v},n.createElement(At,{onChallengeComplete:p,onChallengeShown:g,onCheckboxRendered:h})),e===Pt.Submitting&&n.createElement(s.Z,{vertical:"unit-3x"},n.createElement("div",{className:Lt.LoaderContainer},n.createElement(_e.Z,null)))))}function It({children:e}){const{captchaAdapter:t,captcha:{challenge_displayed:o}}=m(),a=(0,n.useMemo)((()=>{switch(null==t?void 0:t.config.type){case"recaptcha":return o?n.createElement(Rt,null):null;case"hcaptcha":return n.createElement(Tt,null);default:return null}}),[null==t?void 0:t.config.type,o]);return n.createElement(n.Fragment,null,!o&&e,a)}!function(e){e.Loading="loading",e.Ready="ready",e.ChallengeShown="challenge_shown",e.Submitting="submitting"}(Pt||(Pt={}));var Ot=o("./app/ui/utilities/analytics/sectionEvents/shopIdentityEvents.ts");const Vt={sections:{userCard:"all",email:"all",phone:"all",verification:"all",captcha:"all"},elements:{loader:!0,formTitle:!0,formDescription:!0,componentTitle:!1},spaces:{loader:"none",formTitle:"none",formDescription:"regular",componentTitle:"none"},showCaptchaHeader:!0,showUserPhone:!0,showAvatar:!0,smallUserCard:!1,smallLoaderSpace:!1,mobileOptimizedInputs:!1,verificationFooter:{marginTop:"unit-8x",marginBottom:"unit-3x"}},Nt={default:Vt,authorize:{...Vt,sections:{...Vt.sections,email:"spaced",phone:"spaced"},elements:{...Vt.elements,formTitle:!1,componentTitle:!0}},authorizeCommon:{...Vt,sections:{...Vt.sections,userCard:"spaced-vertical",email:"none",phone:"none",verification:"none",captcha:"none"},spaces:{...Vt.spaces,formDescription:"none"},showUserPhone:!1,showAvatar:!1,smallUserCard:!0,smallLoaderSpace:!0,showCaptchaHeader:!1,elements:{...Vt.elements,formTitle:!1,formDescription:!1},verificationFooter:{marginTop:"unit-6x",marginBottom:!1},mobileOptimizedInputs:!0},emailCapture:{...Vt,sections:{...Vt.sections,userCard:"spaced-vertical",verification:"none"},spaces:{...Vt.spaces,formDescription:"none"},showUserPhone:!1,showAvatar:!1,smallUserCard:!0,smallLoaderSpace:!0,mobileOptimizedInputs:!0,showCaptchaHeader:!1,verificationFooter:{marginTop:"unit-6x",marginBottom:!1}},followOnShop:{...Vt,sections:{...Vt.sections,userCard:"spaced-vertical",email:"none",phone:"none",verification:"none",captcha:"none"},spaces:{...Vt.spaces,formDescription:"none"},showUserPhone:!1,showAvatar:!1,smallUserCard:!0,smallLoaderSpace:!0,mobileOptimizedInputs:!0,showCaptchaHeader:!1,verificationFooter:{marginTop:"unit-6x",marginBottom:!1}},modal:{...Vt,sections:{...Vt.sections,userCard:"bottom-tight",phone:"spaced",verification:"spaced"},showCaptchaHeader:!1},paymentPage:{...Vt,elements:{...Vt.elements,loader:!1}},wallet:{...Vt,sections:{...Vt.sections,email:"none"}},redesign:{...Vt,sections:{...Vt.sections,userCard:"top",phone:"spaced",verification:"spaced"},showAvatar:!1}};var Dt={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",Identity:"DROWl"};function Zt({disallowUserChange:e,userCardAction:t,fallbackSmsOptOut:o,landingHeader:a,showLegalCopy:r,onStepChange:i}){const{step:s,captcha:{challenge_displayed:c}}=m();!function({callback:e}){const{captcha:{challenge_displayed:t},session:o,source:a="login",step:r,user:i}=m();(0,n.useEffect)((()=>{const n=t?d.Ao.CaptchaStep:r,s={source:a,step:n,user:{email:i.email||o.email||"",phone_number:i.phone_number||o.phone||""}};null==e||e(s)}),[e,t,o.email,o.phone,a,r,i.email,i.phone_number])}({callback:i});const u=s!==d.Ao.EmailStep||c;return n.createElement("div",{className:Dt.Identity},n.createElement(se,{type:"componentTitle"},n.createElement(Ct,null)),u&&n.createElement(z,{disallowUserChange:e,action:t}),n.createElement(It,null,function(){switch(s){case d.Ao.SmsVerificationStep:case d.Ao.EmailVerificationStep:case d.Ao.AppVerificationStep:return n.createElement(Je,{fallbackSmsOptOut:o});case d.Ao.PhoneStep:return n.createElement(bt,{showLegalCopy:r});default:return n.createElement(n.Fragment,null,a,n.createElement(Et,null))}}()))}function Mt({email:e,source:t,captcha:o,additionalApiPayload:a,onUserCancel:r,onUserFound:i,onUserNotFound:s,onUserSignUp:c,onCaptchaChallenge:d,onCaptchaLoad:u,onLoadExperiments:l,onVerificationSuccess:f,trackingSetup:b,layout:p="default",texts:g,signUpEnabled:m,fastLogin:k=!1,allowWebauthnAutoPrompt:y=!1,passkeyExpVariant:v,..._}){const E=(0,n.useMemo)((()=>function(e){return{displayEmailForm:{schemaId:Ot.Q,payload:{action:"display_email_form",...e}},displayPasskeyLoginButton:t=>({schemaId:Ot.Q,payload:{action:"display_passkey_login_button",origin:t,...e}}),clickPasskeyLoginButton:t=>({schemaId:Ot.Q,payload:{action:"click_passkey_login_button",origin:t,...e}}),displayPhoneForm:{schemaId:Ot.Q,payload:{action:"display_phone_form",...e}},displayReCaptchaV2Form:{schemaId:Ot.Q,payload:{action:"display_reCaptchaV2_form",...e}},displayHCaptchaForm:{schemaId:Ot.Q,payload:{action:"display_hcaptcha_form",...e}},displaySmsVerificationForm:t=>({schemaId:Ot.Q,payload:{action:"display_sms_verification_form",shopAccountUuid:t,...e}}),displayAppVerificationForm:t=>({schemaId:Ot.Q,payload:{action:"display_app_verification_form",shopAccountUuid:t,...e}}),displayEmailVerificationForm:t=>({schemaId:Ot.Q,payload:{action:"display_email_verification_form",shopAccountUuid:t,...e}}),errorNoCaptchaSetUp:{schemaId:Ot.Q,payload:{action:"error_no_captcha_set_up",...e}},switchVerificationType:t=>({schemaId:Ot.Q,payload:{action:"click_switch_verification_type",shopAccountUuid:t,...e}}),autoPromptPasskeyLogin:t=>({schemaId:Ot.Q,payload:{action:"autoprompt_passkey_login",origin:t,...e}})}}(b)),[b]),S=function(e){return Nt[e]}(p),C=o?K(o):void 0;return n.createElement(h,{email:e,source:t,fastLogin:k,additionalApiPayload:a,onUserCancel:r,onUserFound:i,onUserNotFound:s,onUserSignUp:c,onLoadExperiments:l,onVerificationSuccess:f,tracking:E,layoutStyle:S,texts:g,captchaAdapter:C,onCaptchaChallenge:d,onCaptchaLoad:u,signUpEnabled:m,allowWebauthnAutoPrompt:y,passkeyExpVariant:v},n.createElement(Zt,_))}},"./app/ui/sections/components/Identity/components/VerificationStep/components/VerificationNotification/VerificationNotification.tsx":function(e,t,o){o.d(t,{Z:function(){return d}});var n=o("../caches/app/node_modules/react/index.js"),a=o("../caches/app/node_modules/classnames/index.js"),r=o.n(a),i=o("./app/ui/icons/info.svg"),s=o("./app/ui/components/Icon/Icon.tsx"),c={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",VerificationNotification:"X1nzC",Icon:"I2ES_",LabelWrapper:"TDNaY",info:"ABzA8",success:"dATEx",error:"HlYVi"};function d({children:e,type:t}){const o=r()(c.VerificationNotification,t&&c[t]);return n.createElement("div",{className:o},n.createElement("div",{className:c.LabelWrapper},t&&n.createElement("span",{className:c.Icon},n.createElement(s.Z,{svg:i.Z,size:16})),n.createElement("span",{role:"alert"},e)))}},"./app/ui/sections/components/Identity/types/data.ts":function(e,t,o){let n,a,r,i,s;o.d(t,{Ao:function(){return a},CV:function(){return r},Qi:function(){return s},R4:function(){return n},Rb:function(){return i}}),function(e){e.SmsVerification="sms",e.EmailVerification="email",e.AppVerification="app"}(n||(n={})),function(e){e.EmailStep="email_step",e.PhoneStep="phone_step",e.CaptchaStep="captcha_step",e.SmsVerificationStep="sms_verification_step",e.EmailVerificationStep="email_verification_step",e.AppVerificationStep="app_verification_step"}(a||(a={})),function(e){e.SetEmail="set_email",e.SetEmailStep="set_email_step",e.SetPhoneStep="set_phone_step",e.SetVerificationStep="set_verification_step",e.SetCaptchaState="set_captcha_state",e.SetCaptchaReady="set_captcha_ready",e.SetWebauthnErrorMessage="set_webauthn_error_message",e.SetSubmitState="set_submit_state",e.ResetCaptchaPassiveSubmit="reset_captcha_passive_submit",e.ResetSmsToken="reset_sms_token",e.ResetEmailToken="reset_email_token",e.ResetAppToken="reset_app_token"}(r||(r={})),function(e){e.Loading="loading",e.Ready="ready"}(i||(i={})),function(e){e[e.Button=0]="Button",e[e.Link=1]="Link"}(s||(s={}))},"./app/ui/sections/components/Identity/utilities/useIdentityTexts.tsx":function(e,t,o){o.d(t,{U:function(){return r}});var n=o("../caches/app/node_modules/react/index.js"),a=o("./app/ui/utilities/translation/TranslationProvider.tsx");function r(){const{translate:e}=(0,n.useContext)(a.OB);return{identityTexts:{passkeysLabel:e("settings.login.passkeys.passkey_sign_in"),user:{change:e("settings.general.change"),endingWith:t=>e("settings.login.phone_ending_with",{last_digits:t})},emailStep:{title:e("settings.login.email_form.title"),description:e("settings.login.email_form.placeholder"),placeholder:e("settings.section.account_settings.email"),buttonContent:e("settings.login.email_form.btn_submit"),posTitle:e("settings.login.email_form.pos.title"),posDescription:e("settings.login.email_form.pos.description"),passkeyLabel:e("settings.login.email_form.passkeys.label"),errors:{throttled:e("settings.login.error.email_throttled"),notValid:e("modal.errors.enter_valid_email"),generic:e("modal.errors.server.title")}},phoneStep:{title:e("accounts.login.phone_number_form.title"),description:e("accounts.login.phone_number_form.description"),placeholder:e("accounts.login.phone_number_form.input"),buttonContent:e("settings.login.phone_form.btn_submit"),posTitle:e("settings.login.phone_form.pos.title"),errors:{throttled:e("settings.login.error.email_throttled"),notValid:e("modal.errors.enter_valid_phone"),tooMany:e("modal.errors.phone_limit_reached"),generic:e("modal.errors.server.title")}},verificationStep:{sms:{title:e("settings.login.phone_verification_form.title"),label:e("modal.code_input_label"),description:e("settings.login.phone_verification_form.description"),endingWith:t=>e("modal.aria_content_email",{lastDigits:t}),optOut:e("settings.login.phone_verification_form.no_code_help"),errors:{notValid:e("modal.errors.enter_valid_code"),generic:e("modal.errors.server.title")},expired:{title:e("settings.login.sms_expired.title"),action:e("settings.login.sms_expired.action")},throttled:{title:e("settings.login.recovery.throttled_form.title"),description:e("settings.login.recovery.throttled_form.code_description")}},email:{title:e("settings.login.email_verification.title"),label:e("modal.code_input_label"),description:t=>e("settings.login.email_verification.description",{user_email:n.createElement("strong",{key:"user-email"},t)}),optOut:e("settings.login.recovery.email.use_sms"),errors:{notValid:e("modal.errors.enter_valid_code"),generic:e("modal.errors.server.title")},expired:{title:e("settings.login.email_code_expired.title"),action:e("settings.login.email_code_expired.action")},throttled:{title:e("settings.login.recovery.throttled_form.title"),description:e("settings.login.recovery.throttled_form.code_description")}},app:{title:e("settings.login.app_verification.title")}},captcha:{title:e("accounts.login.captcha.hcaptcha_header")}}}}},"./app/ui/sections/components/ShopAuthInputField/ShopAuthInputField.tsx":function(e,t,o){o.d(t,{Z:function(){return y}});var n=o("../caches/app/node_modules/react/index.js"),a=o("./app/ui/components/Input/Input.tsx"),r=o("../caches/app/node_modules/@bugsnag/js/browser/notifier.js"),i=o.n(r),s=o("../caches/app/node_modules/@github/webauthn-json/dist/esm/webauthn-json.browser-ponyfill.js"),c=o("./app/ui/utilities/passkey/isPasskeysLoginSupported.ts"),d=o("./app/ui/api/account/Account.ts"),u=o("./app/ui/types/webauthn_credential.ts"),l=o("./app/ui/types/account.ts"),f=o("./app/ui/utilities/translation/TranslationProvider.tsx"),b=o("./app/ui/utilities/passkey/api.ts"),p=o("./app/ui/utilities/passkey/useAbortController.ts");const g="Cancel passkey autofill";function h({additionalApiPayload:e,onError:t,onLoading:o,onReady:a,onSuccess:r}){const{translate:h}=(0,n.useContext)(f.OB),[m,k]=(0,n.useState)(!1),{getSignal:y}=(0,p.Z)(g),v=(0,n.useRef)(!1);(0,n.useEffect)((()=>{!async function(){k(Boolean(await async function(){var e,t,o;return null===(e=window)||void 0===e||null===(t=e.PublicKeyCredential)||void 0===t||null===(o=t.isConditionalMediationAvailable)||void 0===o?void 0:o.call(t)}()))}()}),[]);const _=(0,n.useMemo)(c.Z,[]),E=(0,n.useCallback)((e=>{switch(e){case u.b.CREDENTIALS_NOT_FOUND:return h("settings.login.email_form.passkeys.errors.invalid");case l.fu.THROTTLED:return h("settings.login.error.email_throttled");default:return h("settings.login.email_form.passkeys.errors.generic")}}),[h]),S=(0,n.useCallback)((async n=>{try{const t=await(0,b.h)({...e,email:n});if(null!=t&&t.public_key_credential_request_options){const n=await(0,s.U2)((0,s.wz)({mediation:"conditional",publicKey:t.public_key_credential_request_options,signal:y()}));null==o||o();const a=await(0,d.W3)({...e,verification_token:JSON.stringify(n),verification_type:"webauthn"});null==r||r(a)}}catch(l){var c;if(null!==(c=y())&&void 0!==c&&c.aborted)return;l!==u.b.CREDENTIALS_NOT_FOUND&&i().notify(l),null==t||t(E(l)),null==a||a()}}),[y,t,o,a,r,e,E]);(0,n.useEffect)((()=>{!v.current&&m&&_&&(v.current=!0,S())}),[m,_,S])}var m={"background--regular":"#fff","background--text":"#000","background--subdued":"#f9fbfd","background--placeholder":"#f0f2f4","background--primary":"#eeeaff","foreground--regular":"#121314","foreground--secondary":"#666","foreground--contrasting":"#fff","highlights--primary":"#5433eb","highlights--dangerous":"#d92a0f","highlights--primary-hover":"#7b61f0","highlights--dangerous-hover":"#f0452b","highlights--success":"#0b8938","dividers--regular":"#d9d9d9","dividers--inputs":"rgba(0,0,0,0.35)","background--primary-light":"#eeeaff","background--dangerous":"#ffece9","background-success":"#6fd493","notification-text":"rgba(0,0,0,0.7)","notification--dangerous-background":"#ffe6e4","notification--dangerous-border":"#f2dad9","notification--info-background":"#f0f2f4","notification--info-border":"#dfdaef","notification--info-light-background":"#ebe6fc","notification--success-background":"#d3fdf2","notification--success-border":"#c8f0e6","notification--disabled-background":"#fff","notification--disabled-border":"rgba(0,0,0,0.15)","discounts--color":"rgba(0,0,0,0.6)","discounts--background":"rgba(0,0,0,0.15)","discounts--border":"rgba(0,0,0,0)","buttons--primary-background":"#5433eb","buttons--primary-background-hover":"#7f68e9","buttons--secondary-hover":"#bdadfb","buttons--secondary-background":"#ebe6fc","buttons--secondary-background-hover":"#dbd1ff","buttons--secondary-color":"#3f22ab","buttons--secondary-color-hover":"#5433eb","buttons--disabled":"rgba(0,0,0,0.7)","buttons--disabled-background":"rgba(0,0,0,0.35)","buttons--transparent-hover":"#f0f2f4","buttons--transparent-hover-color":"#5433eb","buttons--subdued-background":"#f7f5ff","buttons--secondary-disabled-background":"#f3f3f5","buttons--secondary-disabled-color":"#cbcbca","autocomplete--option":"rgba(0,0,0,0.7)","autocomplete--selected":"rgba(0,0,0,0.03)","autocomplete--footer-background":"rgba(0,0,0,0.03)","autocomplete--footer-text":"#737373","radiobutton--background":"#fff","radiobutton--base-background":"rgba(0,0,0,0.35)","radiobutton--disabled-background":"rgba(0,0,0,0.03)","radiobutton--disabled-shadow":"rgba(0,0,0,0.15)","radiobutton--disabled-checked":"rgba(0,0,0,0.15)","affirm--disabled":"#bababa","affirm--regular":"#5a31f4","affirm--simple":"#000","link--background-hover":"rgba(0,0,0,0.03)","currency-pill--background":"#666","currency-pill--border":"#666","actions--background":"#f0f2f4","actions--background-hover":"#d3d9de","line-loading--background-start":"#c4c4c4","line-loading--background-end":"#dadada","icon--success-fill":"#11efb6","icon--white-stroke":"#fff","icon--tooptip-fill":"#a6a6a6","progress--background":"#ebe6fc","progress--line":"#5433eb","shop-cash--background":"#e4f6eb","shop-cash--foreground":"#004839","shop-promise--logo":"#0f1721","shop-promise--logo--accented":"#5632eb",ShopAuthInputField:"DhmNL"};function k(){return k=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},k.apply(this,arguments)}function y({id:e,value:t="",onChange:o,describedBy:r,inputRef:i,mobileOptimized:s,placeholder:c="",additionalAuthPayload:d,onAuthSuccess:u,onAuthError:l,onAuthLoading:f,onAuthReady:b,noBorder:p=!1,onKeyDown:g}){h({additionalApiPayload:d,onSuccess:u,onError:l,onLoading:f,onReady:b});const y={id:e,label:c,value:t,onChange:(0,n.useCallback)((e=>{null==o||o(e.trim())}),[o]),noBorder:p,...r&&{describedBy:r},...i&&{ref:i},...s&&{mobileOptimized:s},onKeyDown:g};return n.createElement("div",{className:m.ShopAuthInputField},n.createElement(a.Z,k({},y,{autoComplete:"email webauthn",type:"email",required:!0})))}},"./app/ui/sections/utilities/constants.ts":function(e,t,o){let n;o.d(t,{W:function(){return a},e:function(){return n}}),function(e){e.Account="account",e.Wallet="wallet",e.Checkout="checkout",e.CheckoutOne="checkoutOne",e.PaymentPage="paymentPage",e.PaymentPageCheckoutOne="checkoutOneLogin",e.LoginWithShop="loginWithShop",e.LoginWithShopDiscount="loginWithShopDiscount",e.LoginWithShopFollow="loginWithShopFollow",e.LoginWithShopClassicCustomerAccounts="loginWithShopClassicCustomerAccounts",e.LoginWithShopSelfServe="loginWithShopSelfServe",e.LoginWithShopShopAppChat="loginWithShopShopAppChat",e.LoginWithShopCashReward="loginWithShopCashReward"}(n||(n={}));const a={SHOP_PAY_INSTALLMENTS_APPROVAL_COMPLETED:"SHOP_PAY_INSTALLMENTS_APPROVAL_COMPLETED",SHOP_PAY_INSTALLMENTS_VERIFICATION_FAILED:"SHOP_PAY_INSTALLMENTS_VERIFICATION_FAILED",SHOP_PAY_INSTALLMENTS_VERIFICATION_COMPLETED:"SHOP_PAY_INSTALLMENTS_VERIFICATION_COMPLETED",SHOP_PAY_INSTALLMENTS_PLAN_SELECTED:"SHOP_PAY_INSTALLMENTS_PLAN_SELECTED",SHOP_PAY_INSTALLMENTS_APPROVAL_FAILED:"SHOP_PAY_INSTALLMENTS_APPROVAL_FAILED",SHOP_PAY_INSTALLMENTS_CLASSIC_ERROR_PAY_AT_COUNTER_SELECTED:"SHOP_PAY_INSTALLMENTS_CLASSIC_ERROR_PAY_AT_COUNTER_SELECTED",SHOP_PAY_INSTALLMENTS_CLASSIC_ERROR_PAY_NOW_SELECTED:"SHOP_PAY_INSTALLMENTS_CLASSIC_ERROR_PAY_NOW_SELECTED"}},"./app/ui/types/webauthn_credential.ts":function(e,t,o){o.d(t,{b:function(){return n}});const n={CREDENTIALS_NOT_FOUND:"credentials_not_found"}},"./app/ui/utilities/UIContextProvider/UIContextProvider.tsx":function(e,t,o){o.d(t,{DD:function(){return s},MS:function(){return c},QE:function(){return i},pl:function(){return r},wH:function(){return a}});var n=o("../caches/app/node_modules/react/index.js");let a;!function(e){e.AddressRead="uma:pay:address:read",e.CreditCardRead="uma:pay:credit_card:read",e.CreditCardReadEncrypted="uma:pay:credit_card:read_encrypted",e.EmailRead="email"}(a||(a={}));const r={authorizeThirdParty:!1,clientName:"",displayName:"",privacyUrl:"",termsUrl:"",scopes:[],requestedRedirectUri:"",isShopServer:!1},i=n.createContext(r);function s({children:e,...t}){const o=(0,n.useMemo)((()=>t),[t]);return n.createElement(i.Provider,{value:o},e)}function c(){return(0,n.useContext)(i)}},"./app/ui/utilities/analytics/sectionEvents/loginEvents.ts":function(e,t,o){o.d(t,{$:function(){return a},n:function(){return n}});const n="shopify_pay_login_page_ui_interaction/1.1",a="pay.login.time_to_sms"},"./app/ui/utilities/captchaConfig/getCaptchaConfig.ts":function(e,t,o){o.d(t,{m:function(){return a}});var n=o("./app/ui/utilities/browser/browser.ts");function a(){const e=function(){const e=(0,n.mW)("recaptcha_v2_site_key"),t=(0,n.mW)("recaptcha_v3_site_key"),o="string"==typeof t;if("string"==typeof e&&o)return{reCaptchaV2SiteKey:e,reCaptchaV3SiteKey:t}}(),t=function(){const e=(0,n.mW)("hcaptcha_site_key");if("string"==typeof e)return{hCaptchaSiteKey:e}}();return e?{type:"recaptcha",...e}:t?{type:"hcaptcha",...t}:void 0}},"./app/ui/utilities/passkey/api.ts":function(e,t,o){o.d(t,{h:function(){return d}});var n=o("./app/ui/api/utilities/ApiFetcher.ts"),a=o("./app/ui/api/utilities/types.ts"),r=o("./app/ui/api/utilities/index.ts"),i=o("./app/ui/utilities/url/url.ts");const s=n.a.default;class c extends a.V{constructor(e){super(e,"generate challenge for passkeys login"),this.name="GenerateLoginPasskeysResponseError"}}async function d(e){try{const t=await s.fetch(i.HQ.webauthnLogin(),{method:"POST",headers:r.cV,body:JSON.stringify(e)});if(!t.ok)throw new c(t);return t.json()}catch(o){var t;const{errors:e}=await o.response.json();if(null!==(t=e[0])&&void 0!==t&&t.code)throw e[0].code}}},"./app/ui/utilities/passkey/isPasskeysLoginEnabled.ts":function(e,t,o){o.d(t,{Z:function(){return r}});var n=o("./app/ui/utilities/browser/cookies.ts");const a="enable_passkeys_login";function r(){var e;const t=(0,n.e)(a);return null!==t?"true"===t:Boolean(null===(e=window.ShopifyPay.Config)||void 0===e?void 0:e.passkeyLogin)}},"./app/ui/utilities/passkey/isPasskeysLoginSupported.ts":function(e,t,o){o.d(t,{Z:function(){return s}});var n=o("./app/ui/utilities/url/url.ts"),a=o("./app/ui/utilities/env.ts"),r=o("./app/ui/utilities/passkey/isPasskeysLoginEnabled.ts"),i=o("./app/ui/utilities/passkey/isPasskeysSupportedBrowser.ts");function s(){return(0,r.Z)()&&(0,i.Z)()&&window.self.location.host===n.HQ.internal(a.y).Alternate}},"./app/ui/utilities/passkey/isPasskeysSupportedBrowser.ts":function(e,t,o){o.d(t,{Z:function(){return s}});var n=o("../caches/app/node_modules/@shopify/browser/build/esnext/browser.esnext"),a=o("../caches/app/node_modules/ua-parser-js/src/ua-parser.js");const r=16,i=e=>{const[t]=e.split(".");return parseInt(t,10)};function s(e=window.navigator.userAgent){const t=new n.A({userAgent:e}),o=new a.UAParser(e).getOS(),s=e.includes("FBAN")||e.includes("FBAV"),c=e.includes("Instagram"),d=t.isFirefox&&t.isDesktop,u=t.isIOS&&o.version&&i(o.version)<r,l=t.isWindows;return!(s||c||d||u||l)}},"./app/ui/utilities/passkey/useAbortController.ts":function(e,t,o){o.d(t,{Z:function(){return a}});var n=o("../caches/app/node_modules/react/index.js");function a(e){const t=(0,n.useRef)();(0,n.useEffect)((()=>()=>{var o,n;return null===(o=t.current)||void 0===o||null===(n=o.abort)||void 0===n?void 0:n.call(o,e)}),[e]);return{getSignal:(0,n.useCallback)((()=>{var e;return!t.current&&window.AbortController&&(t.current=new window.AbortController),null===(e=t.current)||void 0===e?void 0:e.signal}),[])}}},"./app/ui/utilities/redesign/useRedesign.ts":function(e,t,o){o.d(t,{u:function(){return a}});var n=o("./app/ui/utilities/url/utilities.ts");function a(){const e=(0,n.vl)(["isRedesign"]);return"true"===(null==e?void 0:e.isRedesign)}},"./app/ui/utilities/retail/usePointOfSale.ts":function(e,t,o){o.d(t,{g:function(){return i},i:function(){return s}});var n=o("../caches/app/node_modules/react/index.js"),a=o("./app/ui/utilities/url/utilities.ts"),r=o("./app/ui/types/checkout.ts");function i(){const e=(0,a.vl)(["isPointOfSale"]);return"true"===(null==e?void 0:e.isPointOfSale)}const s=(e,t,o,i)=>(0,n.useMemo)((()=>{const n=(0,a.vl)(["userId","shopId","locationId","posCheckoutToken","totalOrderValue","cartItemsCount","installmentsEligible","posDeviceId","ineligibilityReason"]),s=e.verified&&"verified"===e.installments_outcome,c=o.includes(r.eW.SplitPay),d=o.includes(r.eW.ZeroPercent),u=o.includes(r.eW.Interest);return{userId:parseInt((null==n?void 0:n.userId)||"0",10),shopId:parseInt((null==n?void 0:n.shopId)||"0",10),locationId:parseInt((null==n?void 0:n.locationId)||"0",10),posCheckoutToken:(null==n?void 0:n.posCheckoutToken)||"",totalOrderValue:parseInt((null==n?void 0:n.totalOrderValue)||"0",10),cartItemsCount:parseInt((null==n?void 0:n.cartItemsCount)||"0",10),installmentsEligible:Boolean(null==n?void 0:n.installmentsEligible),posDeviceId:(null==n?void 0:n.posDeviceId)||"",preenrolled:s,shopPayCheckoutToken:t,currency:i||"Usd",splitPayEligible:c,interestBearingEligible:u||!1,zeroPercentEligible:d,ineligibilityReason:(null==n?void 0:n.ineligibilityReason)||""}}),[e,o,i,t])}}]);